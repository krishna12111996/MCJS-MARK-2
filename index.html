<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moot Court Competition Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        .timer-display {
            font-family: 'Courier New', monospace;
            font-size: 2rem;
            font-weight: bold;
        }
        .bell-animation {
            animation: ring 0.5s ease-in-out;
        }
        @keyframes ring {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-10deg); }
            75% { transform: rotate(10deg); }
        }
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg border-b-4 border-blue-600">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                <h1 class="text-2xl font-bold text-gray-800">Moot Court Management System</h1>
                <div class="flex space-x-4">
                    <button onclick="showPortal('admin')" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors">Admin</button>
                    <button onclick="showPortal('judge')" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors">Judge</button>
                    <button onclick="showPortal('manager')" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors">Court Manager</button>
                    <button onclick="showPortal('dashboard')" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg transition-colors">Dashboard</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Admin Portal -->
    <div id="admin-portal" class="portal hidden">
        <div class="max-w-6xl mx-auto p-6">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">Admin Portal</h2>
            
            <!-- Admin Login -->
            <div id="admin-login" class="bg-white rounded-xl shadow-lg p-8 mb-8">
                <h3 class="text-2xl font-semibold mb-6 text-center text-gray-700">Admin Login</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <button onclick="showAdminSection('create-competition')" class="bg-blue-600 hover:bg-blue-700 text-white py-4 px-6 rounded-lg text-lg font-semibold transition-colors">Create Competition</button>
                    <button onclick="showAdminSection('court-assignment')" class="bg-green-600 hover:bg-green-700 text-white py-4 px-6 rounded-lg text-lg font-semibold transition-colors">Court Assignment</button>
                    <button onclick="showAdminSection('manage-assignment')" class="bg-purple-600 hover:bg-purple-700 text-white py-4 px-6 rounded-lg text-lg font-semibold transition-colors">Manage Assignment</button>
                </div>
            </div>

            <!-- Create Competition -->
            <div id="create-competition" class="admin-section hidden bg-white rounded-xl shadow-lg p-8">
                <h3 class="text-2xl font-semibold mb-6 text-gray-700">Create Competition</h3>
                <form id="competition-form" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">College Name</label>
                        <input type="text" id="college-name" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Competition Name</label>
                        <input type="text" id="competition-name" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Date of Competition</label>
                        <input type="date" id="competition-date" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">No of Teams Participating</label>
                        <input type="number" id="teams-count" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="1" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">No of Court Rooms Allocated</label>
                        <input type="number" id="courtrooms-count" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="1" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Time Allocated per Team (minutes)</label>
                        <input type="number" id="time-per-team" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="1" value="30" required>
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Rounds</label>
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="prelims1" class="w-4 h-4 text-blue-600">
                                <span>Prelims 1</span>
                            </label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="prelims2" class="w-4 h-4 text-blue-600">
                                <span>Prelims 2</span>
                            </label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="octa" class="w-4 h-4 text-blue-600">
                                <span>Octa</span>
                            </label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="quarters" class="w-4 h-4 text-blue-600">
                                <span>Quarters</span>
                            </label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="semi" class="w-4 h-4 text-blue-600">
                                <span>Semi</span>
                            </label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="finals" class="w-4 h-4 text-blue-600">
                                <span>Finals</span>
                            </label>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">College Logo URL</label>
                        <input type="url" id="college-logo" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Moot Society Logo URL</label>
                        <input type="url" id="society-logo" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div class="md:col-span-2">
                        <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 px-6 rounded-lg text-lg font-semibold transition-colors">Create Competition</button>
                    </div>
                </form>
            </div>

            <!-- Court Assignment -->
            <div id="court-assignment" class="admin-section hidden bg-white rounded-xl shadow-lg p-8">
                <h3 class="text-2xl font-semibold mb-6 text-gray-700">Court Assignment</h3>
                <form id="court-assignment-form" class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Select College</label>
                        <select id="college-select" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                            <option value="">Select College</option>
                        </select>
                    </div>
                    <div id="assignment-form" class="hidden space-y-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Competition Name</label>
                            <input type="text" id="comp-name-display" class="w-full p-3 border border-gray-300 rounded-lg bg-gray-100" readonly>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Court Room Number</label>
                                <input type="text" id="court-number" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Round</label>
                                <select id="round-select" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                                    <option value="">Select Round</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Court Password</label>
                                <input type="password" id="court-password" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Number of Judges (1-5)</label>
                                <select id="judges-count" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                                    <option value="">Select</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                </select>
                            </div>
                        </div>
                        <div id="judges-details" class="hidden space-y-4">
                            <h4 class="text-lg font-semibold text-gray-700">Judge Details</h4>
                            <div id="judges-container"></div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Petitioner Team Code</label>
                                <input type="text" id="petitioner-code" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Respondent Team Code</label>
                                <input type="text" id="respondent-code" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Court Manager Name</label>
                                <input type="text" id="manager-name" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Manager Password</label>
                                <input type="password" id="manager-password" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                            </div>
                        </div>
                        <button type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white py-3 px-6 rounded-lg text-lg font-semibold transition-colors">Submit Assignment</button>
                    </div>
                </form>
            </div>

            <!-- Manage Assignment -->
            <div id="manage-assignment" class="admin-section hidden bg-white rounded-xl shadow-lg p-8">
                <h3 class="text-2xl font-semibold mb-6 text-gray-700">Manage Assignment</h3>
                <div id="manage-colleges" class="space-y-4"></div>
            </div>
        </div>
    </div>

    <!-- Judge Portal -->
    <div id="judge-portal" class="portal hidden">
        <div class="max-w-4xl mx-auto p-6">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">Judge Portal</h2>
            
            <!-- Judge Login -->
            <div id="judge-login" class="bg-white rounded-xl shadow-lg p-8 mb-8">
                <h3 class="text-2xl font-semibold mb-6 text-center text-gray-700">Judge Login</h3>
                <form id="judge-login-form" class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Competition Name</label>
                        <select id="judge-competition" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                            <option value="">Select Competition</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Court Room Number</label>
                        <select id="judge-courtroom" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                            <option value="">Select Court Room</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Judge Name</label>
                        <select id="judge-name" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                            <option value="">Select Judge</option>
                        </select>
                    </div>
                    <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 px-6 rounded-lg text-lg font-semibold transition-colors">Login</button>
                </form>
            </div>

            <!-- Score Sheet -->
            <div id="score-sheet" class="hidden bg-white rounded-xl shadow-lg p-8">
                <h3 class="text-2xl font-semibold mb-6 text-gray-700">Score Sheet</h3>
                <div id="scoring-section">
                    <!-- Team Selection -->
                    <div id="team-selection" class="mb-8">
                        <div class="flex justify-center space-x-4">
                            <button id="petitioner-btn" onclick="selectTeam('petitioner')" class="bg-blue-600 hover:bg-blue-700 text-white py-3 px-6 rounded-lg text-lg font-semibold transition-colors">Score Petitioner</button>
                            <button id="respondent-btn" onclick="selectTeam('respondent')" class="bg-green-600 hover:bg-green-700 text-white py-3 px-6 rounded-lg text-lg font-semibold transition-colors hidden">Score Respondent</button>
                        </div>
                    </div>

                    <!-- Scoring Form -->
                    <div id="scoring-form" class="hidden">
                        <h4 id="current-team" class="text-xl font-semibold mb-6 text-center"></h4>
                        
                        <!-- Speaker Selection -->
                        <div class="mb-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Speaker 1 Gender</label>
                                    <select id="speaker1-gender" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                                        <option value="">Select Gender</option>
                                        <option value="Male">Male</option>
                                        <option value="Female">Female</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Speaker 2 Gender</label>
                                    <select id="speaker2-gender" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                                        <option value="">Select Gender</option>
                                        <option value="Male">Male</option>
                                        <option value="Female">Female</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Scoring Parameters -->
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <!-- Speaker 1 -->
                                <div class="border rounded-lg p-4">
                                    <h5 class="text-lg font-semibold mb-4 text-center">Speaker 1</h5>
                                    <div class="space-y-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Perusal of Facts (10 marks)</label>
                                            <input type="number" id="s1-perusal" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" min="0" max="10" required>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Knowledge & Application of Law (20 marks)</label>
                                            <input type="number" id="s1-knowledge" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" min="0" max="20" required>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Organization & Presentation (20 marks)</label>
                                            <input type="number" id="s1-organization" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" min="0" max="20" required>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Clarity & Legal Reasoning (20 marks)</label>
                                            <input type="number" id="s1-clarity" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" min="0" max="20" required>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Persuasiveness & Response (20 marks)</label>
                                            <input type="number" id="s1-persuasiveness" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" min="0" max="20" required>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Team Coordination (10 marks)</label>
                                            <input type="number" id="s1-coordination" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" min="0" max="10" required>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Courtroom Etiquette (10 marks)</label>
                                            <input type="number" id="s1-etiquette" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" min="0" max="10" required>
                                        </div>
                                    </div>
                                </div>

                                <!-- Speaker 2 -->
                                <div class="border rounded-lg p-4">
                                    <h5 class="text-lg font-semibold mb-4 text-center">Speaker 2</h5>
                                    <div class="space-y-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Perusal of Facts (10 marks)</label>
                                            <input type="number" id="s2-perusal" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" min="0" max="10" required>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Knowledge & Application of Law (20 marks)</label>
                                            <input type="number" id="s2-knowledge" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" min="0" max="20" required>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Organization & Presentation (20 marks)</label>
                                            <input type="number" id="s2-organization" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" min="0" max="20" required>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Clarity & Legal Reasoning (20 marks)</label>
                                            <input type="number" id="s2-clarity" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" min="0" max="20" required>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Persuasiveness & Response (20 marks)</label>
                                            <input type="number" id="s2-persuasiveness" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" min="0" max="20" required>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Team Coordination (10 marks)</label>
                                            <input type="number" id="s2-coordination" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" min="0" max="10" required>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Courtroom Etiquette (10 marks)</label>
                                            <input type="number" id="s2-etiquette" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" min="0" max="10" required>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="mt-8 text-center">
                            <button onclick="submitTeamScore()" class="bg-green-600 hover:bg-green-700 text-white py-3 px-8 rounded-lg text-lg font-semibold transition-colors">Submit Score</button>
                        </div>
                    </div>

                    <!-- Thank You Card -->
                    <div id="thank-you-card" class="hidden text-center">
                        <div class="bg-green-50 border border-green-200 rounded-lg p-8">
                            <h3 class="text-2xl font-semibold text-green-800 mb-4">Thank You!</h3>
                            <p class="text-green-700 mb-6">Your scores have been submitted successfully.</p>
                            <button onclick="resetJudgePortal()" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-6 rounded-lg font-semibold transition-colors">Done</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Court Manager Portal -->
    <div id="manager-portal" class="portal hidden">
        <div class="max-w-4xl mx-auto p-6">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">Court Manager Portal</h2>
            
            <!-- Manager Login -->
            <div id="manager-login" class="bg-white rounded-xl shadow-lg p-8 mb-8">
                <h3 class="text-2xl font-semibold mb-6 text-center text-gray-700">Manager Login</h3>
                <form id="manager-login-form" class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Manager Name</label>
                        <select id="manager-name-select" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                            <option value="">Select Manager</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                        <input type="password" id="manager-login-password" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Round</label>
                        <select id="manager-round" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                            <option value="">Select Round</option>
                        </select>
                    </div>
                    <button type="submit" class="w-full bg-purple-600 hover:bg-purple-700 text-white py-3 px-6 rounded-lg text-lg font-semibold transition-colors">Login</button>
                </form>
            </div>

            <!-- Time Keeping Section -->
            <div id="time-keeping" class="hidden bg-white rounded-xl shadow-lg p-8">
                <h3 class="text-2xl font-semibold mb-6 text-gray-700">Time Keeping</h3>
                
                <!-- Time Allocation Setup -->
                <div id="time-setup" class="mb-8">
                    <h4 class="text-lg font-semibold mb-4">Time Allocation (30 minutes total per team)</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <!-- Petitioner Time Setup -->
                        <div class="border rounded-lg p-4">
                            <h5 class="text-md font-semibold mb-4 text-center text-blue-600">Petitioner</h5>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Speaker 1 Time (minutes)</label>
                                    <input type="number" id="pet-s1-time" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" min="1" max="28" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Speaker 2 Time (minutes)</label>
                                    <input type="number" id="pet-s2-time" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" min="1" max="28" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Rebuttal Time (minutes)</label>
                                    <input type="number" id="pet-rebuttal-time" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" min="0" max="28" required>
                                </div>
                                <div class="text-sm text-gray-600">
                                    Total: <span id="pet-total">0</span> minutes
                                </div>
                            </div>
                        </div>

                        <!-- Respondent Time Setup -->
                        <div class="border rounded-lg p-4">
                            <h5 class="text-md font-semibold mb-4 text-center text-green-600">Respondent</h5>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Speaker 1 Time (minutes)</label>
                                    <input type="number" id="res-s1-time" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" min="1" max="28" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Speaker 2 Time (minutes)</label>
                                    <input type="number" id="res-s2-time" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" min="1" max="28" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Rebuttal Time (minutes)</label>
                                    <input type="number" id="res-rebuttal-time" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" min="0" max="28" required>
                                </div>
                                <div class="text-sm text-gray-600">
                                    Total: <span id="res-total">0</span> minutes
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="text-center mt-4">
                        <button onclick="startTimekeeping()" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-6 rounded-lg font-semibold transition-colors">Start Timekeeping</button>
                    </div>
                </div>

                <!-- Timer Display -->
                <div id="timer-display" class="hidden">
                    <div class="text-center mb-8">
                        <h4 id="current-speaker" class="text-xl font-semibold mb-4"></h4>
                        <div id="timer" class="timer-display text-4xl mb-4">00:00:000</div>
                        <div class="space-x-4">
                            <button id="start-btn" onclick="startTimer()" class="bg-green-600 hover:bg-green-700 text-white py-2 px-6 rounded-lg font-semibold transition-colors">Start</button>
                            <button id="pause-btn" onclick="pauseTimer()" class="bg-yellow-600 hover:bg-yellow-700 text-white py-2 px-6 rounded-lg font-semibold transition-colors hidden">Pause</button>
                            <button id="next-speaker-btn" onclick="nextSpeaker()" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-6 rounded-lg font-semibold transition-colors hidden">Next Speaker</button>
                        </div>
                        <div class="mt-4">
                            <button onclick="addExtraTime(120)" class="bg-orange-600 hover:bg-orange-700 text-white py-1 px-4 rounded font-semibold transition-colors mr-2">+2 min</button>
                            <button onclick="addExtraTime(30)" class="bg-orange-600 hover:bg-orange-700 text-white py-1 px-4 rounded font-semibold transition-colors">+30 sec</button>
                        </div>
                    </div>

                    <!-- Bell Icon -->
                    <div class="text-center mb-4">
                        <div id="bell" class="text-4xl">🔔</div>
                    </div>

                    <!-- Progress Tracking -->
                    <div id="progress-tracking" class="bg-gray-50 rounded-lg p-4">
                        <h5 class="font-semibold mb-2">Progress</h5>
                        <div id="progress-list" class="space-y-2"></div>
                    </div>

                    <!-- Submit Button -->
                    <div class="text-center mt-8">
                        <button id="submit-timekeeping" onclick="submitTimekeeping()" class="bg-green-600 hover:bg-green-700 text-white py-3 px-8 rounded-lg text-lg font-semibold transition-colors hidden">Submit Timekeeping</button>
                    </div>
                </div>

                <!-- Thank You Card -->
                <div id="manager-thank-you" class="hidden text-center">
                    <div class="bg-green-50 border border-green-200 rounded-lg p-8">
                        <h3 class="text-2xl font-semibold text-green-800 mb-4">Thank You!</h3>
                        <p class="text-green-700 mb-6">Timekeeping data has been submitted successfully.</p>
                        <button onclick="resetManagerPortal()" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-6 rounded-lg font-semibold transition-colors">Done</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard-portal" class="portal hidden">
        <div class="max-w-7xl mx-auto p-6">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">Dashboard</h2>
            
            <!-- Competition Selection -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
                <div class="flex items-center space-x-4">
                    <label class="text-lg font-semibold text-gray-700">Select Competition:</label>
                    <select id="dashboard-competition" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="">Select Competition</option>
                    </select>
                </div>
            </div>

            <!-- Round Tabs -->
            <div id="dashboard-content" class="hidden">
                <div class="bg-white rounded-xl shadow-lg mb-8">
                    <div class="border-b border-gray-200">
                        <nav class="flex space-x-8 px-6" id="round-tabs">
                            <!-- Tabs will be generated dynamically -->
                        </nav>
                    </div>
                </div>

                <!-- Round Content -->
                <div id="round-content" class="bg-white rounded-xl shadow-lg p-6">
                    <!-- Content will be generated dynamically -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global data storage
        let competitions = JSON.parse(localStorage.getItem('competitions') || '[]');
        let courtAssignments = JSON.parse(localStorage.getItem('courtAssignments') || '[]');
        let judgeScores = JSON.parse(localStorage.getItem('judgeScores') || '[]');
        let timekeepingData = JSON.parse(localStorage.getItem('timekeepingData') || '[]');

        // Current state variables
        let currentPortal = 'admin';
        let currentTeam = '';
        let currentJudgeSession = null;
        let currentManagerSession = null;
        let timerInterval = null;
        let currentTimerData = null;
        let speakerQueue = [];
        let currentSpeakerIndex = 0;

        // Portal Navigation
        function showPortal(portal) {
            document.querySelectorAll('.portal').forEach(p => p.classList.add('hidden'));
            document.getElementById(portal + '-portal').classList.remove('hidden');
            currentPortal = portal;
            
            if (portal === 'judge') {
                loadJudgeCompetitions();
            } else if (portal === 'manager') {
                loadManagerData();
            } else if (portal === 'dashboard') {
                loadDashboard();
            }
        }

        // Admin Portal Functions
        function showAdminSection(section) {
            document.querySelectorAll('.admin-section').forEach(s => s.classList.add('hidden'));
            document.getElementById(section).classList.remove('hidden');
            
            if (section === 'court-assignment') {
                loadCollegeOptions();
            } else if (section === 'manage-assignment') {
                loadManageAssignments();
            }
        }

        // Competition Form Handler
        document.getElementById('competition-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const rounds = [];
            
            ['prelims1', 'prelims2', 'octa', 'quarters', 'semi', 'finals'].forEach(round => {
                if (document.getElementById(round).checked) {
                    rounds.push(round);
                }
            });

            const competition = {
                id: Date.now(),
                collegeName: document.getElementById('college-name').value,
                competitionName: document.getElementById('competition-name').value,
                date: document.getElementById('competition-date').value,
                teamsCount: parseInt(document.getElementById('teams-count').value),
                courtroomsCount: parseInt(document.getElementById('courtrooms-count').value),
                timePerTeam: parseInt(document.getElementById('time-per-team').value),
                rounds: rounds,
                collegeLogo: document.getElementById('college-logo').value,
                societyLogo: document.getElementById('society-logo').value,
                createdAt: new Date().toISOString()
            };

            competitions.push(competition);
            localStorage.setItem('competitions', JSON.stringify(competitions));
            
            alert('Competition created successfully!');
            e.target.reset();
        });

        // Load college options for court assignment
        function loadCollegeOptions() {
            const select = document.getElementById('college-select');
            select.innerHTML = '<option value="">Select College</option>';
            
            competitions.forEach(comp => {
                const option = document.createElement('option');
                option.value = comp.id;
                option.textContent = comp.collegeName;
                select.appendChild(option);
            });
        }

        // Handle college selection
        document.getElementById('college-select').addEventListener('change', function() {
            const competitionId = this.value;
            if (competitionId) {
                const competition = competitions.find(c => c.id == competitionId);
                if (competition) {
                    document.getElementById('comp-name-display').value = competition.competitionName;
                    
                    // Load rounds
                    const roundSelect = document.getElementById('round-select');
                    roundSelect.innerHTML = '<option value="">Select Round</option>';
                    competition.rounds.forEach(round => {
                        const option = document.createElement('option');
                        option.value = round;
                        option.textContent = round.charAt(0).toUpperCase() + round.slice(1);
                        roundSelect.appendChild(option);
                    });
                    
                    document.getElementById('assignment-form').classList.remove('hidden');
                }
            } else {
                document.getElementById('assignment-form').classList.add('hidden');
            }
        });

        // Handle judges count change
        document.getElementById('judges-count').addEventListener('change', function() {
            const count = parseInt(this.value);
            const container = document.getElementById('judges-container');
            container.innerHTML = '';
            
            if (count > 0) {
                for (let i = 1; i <= count; i++) {
                    const judgeDiv = document.createElement('div');
                    judgeDiv.className = 'grid grid-cols-1 md:grid-cols-2 gap-4 p-4 border rounded-lg';
                    judgeDiv.innerHTML = `
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Judge ${i} Title</label>
                            <select id="judge${i}-title" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" required>
                                <option value="">Select Title</option>
                                <option value="Mr.">Mr.</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Miss">Miss</option>
                                <option value="Dr.">Dr.</option>
                                <option value="Prof.">Prof.</option>
                                <option value="Hon.">Hon.</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Judge ${i} Name</label>
                            <input type="text" id="judge${i}-name" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" required>
                        </div>
                    `;
                    container.appendChild(judgeDiv);
                }
                document.getElementById('judges-details').classList.remove('hidden');
            } else {
                document.getElementById('judges-details').classList.add('hidden');
            }
        });

        // Court Assignment Form Handler
        document.getElementById('court-assignment-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const competitionId = document.getElementById('college-select').value;
            const judgesCount = parseInt(document.getElementById('judges-count').value);
            const judges = [];
            
            for (let i = 1; i <= judgesCount; i++) {
                judges.push({
                    title: document.getElementById(`judge${i}-title`).value,
                    name: document.getElementById(`judge${i}-name`).value
                });
            }

            const assignment = {
                id: Date.now(),
                competitionId: competitionId,
                courtNumber: document.getElementById('court-number').value,
                round: document.getElementById('round-select').value,
                courtPassword: document.getElementById('court-password').value,
                judges: judges,
                petitionerCode: document.getElementById('petitioner-code').value,
                respondentCode: document.getElementById('respondent-code').value,
                managerName: document.getElementById('manager-name').value,
                managerPassword: document.getElementById('manager-password').value,
                createdAt: new Date().toISOString()
            };

            courtAssignments.push(assignment);
            localStorage.setItem('courtAssignments', JSON.stringify(courtAssignments));
            
            alert('Court assignment created successfully!');
            e.target.reset();
            document.getElementById('assignment-form').classList.add('hidden');
            document.getElementById('judges-details').classList.add('hidden');
        });

        // Load manage assignments
        function loadManageAssignments() {
            const container = document.getElementById('manage-colleges');
            container.innerHTML = '';
            
            competitions.forEach(comp => {
                const assignments = courtAssignments.filter(a => a.competitionId == comp.id);
                if (assignments.length > 0) {
                    const collegeDiv = document.createElement('div');
                    collegeDiv.className = 'border rounded-lg p-4';
                    collegeDiv.innerHTML = `
                        <h4 class="text-lg font-semibold mb-4 cursor-pointer text-blue-600 hover:text-blue-800" onclick="toggleAssignments('${comp.id}')">
                            ${comp.collegeName} - ${comp.competitionName} (${assignments.length} assignments)
                        </h4>
                        <div id="assignments-${comp.id}" class="hidden space-y-4">
                            ${assignments.map(assignment => `
                                <div class="bg-gray-50 rounded-lg p-4">
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div><strong>Court:</strong> ${assignment.courtNumber}</div>
                                        <div><strong>Round:</strong> ${assignment.round}</div>
                                        <div><strong>Manager:</strong> ${assignment.managerName}</div>
                                        <div><strong>Petitioner:</strong> ${assignment.petitionerCode}</div>
                                        <div><strong>Respondent:</strong> ${assignment.respondentCode}</div>
                                        <div><strong>Judges:</strong> ${assignment.judges.map(j => j.title + ' ' + j.name).join(', ')}</div>
                                    </div>
                                    <div class="mt-4">
                                        <button onclick="editAssignment('${assignment.id}')" class="bg-yellow-600 hover:bg-yellow-700 text-white py-1 px-3 rounded text-sm transition-colors">Edit</button>
                                        <button onclick="deleteAssignment('${assignment.id}')" class="bg-red-600 hover:bg-red-700 text-white py-1 px-3 rounded text-sm transition-colors ml-2">Delete</button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    container.appendChild(collegeDiv);
                }
            });
        }

        function toggleAssignments(competitionId) {
            const element = document.getElementById(`assignments-${competitionId}`);
            element.classList.toggle('hidden');
        }

        function editAssignment(assignmentId) {
            // Implementation for editing assignments
            alert('Edit functionality would be implemented here');
        }

        function deleteAssignment(assignmentId) {
            if (confirm('Are you sure you want to delete this assignment?')) {
                courtAssignments = courtAssignments.filter(a => a.id != assignmentId);
                localStorage.setItem('courtAssignments', JSON.stringify(courtAssignments));
                loadManageAssignments();
            }
        }

        // Judge Portal Functions
        function loadJudgeCompetitions() {
            const select = document.getElementById('judge-competition');
            select.innerHTML = '<option value="">Select Competition</option>';
            
            competitions.forEach(comp => {
                const option = document.createElement('option');
                option.value = comp.id;
                option.textContent = comp.competitionName;
                select.appendChild(option);
            });
        }

        document.getElementById('judge-competition').addEventListener('change', function() {
            const competitionId = this.value;
            const courtroomSelect = document.getElementById('judge-courtroom');
            courtroomSelect.innerHTML = '<option value="">Select Court Room</option>';
            
            if (competitionId) {
                const assignments = courtAssignments.filter(a => a.competitionId == competitionId);
                assignments.forEach(assignment => {
                    const option = document.createElement('option');
                    option.value = assignment.courtNumber;
                    option.textContent = assignment.courtNumber;
                    courtroomSelect.appendChild(option);
                });
            }
        });

        document.getElementById('judge-courtroom').addEventListener('change', function() {
            const competitionId = document.getElementById('judge-competition').value;
            const courtNumber = this.value;
            const judgeSelect = document.getElementById('judge-name');
            judgeSelect.innerHTML = '<option value="">Select Judge</option>';
            
            if (competitionId && courtNumber) {
                const assignment = courtAssignments.find(a => 
                    a.competitionId == competitionId && a.courtNumber === courtNumber
                );
                if (assignment) {
                    assignment.judges.forEach(judge => {
                        const option = document.createElement('option');
                        option.value = judge.title + ' ' + judge.name;
                        option.textContent = judge.title + ' ' + judge.name;
                        judgeSelect.appendChild(option);
                    });
                }
            }
        });

        document.getElementById('judge-login-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const competitionId = document.getElementById('judge-competition').value;
            const courtNumber = document.getElementById('judge-courtroom').value;
            const judgeName = document.getElementById('judge-name').value;
            
            const assignment = courtAssignments.find(a => 
                a.competitionId == competitionId && a.courtNumber === courtNumber
            );
            
            if (assignment) {
                currentJudgeSession = {
                    competitionId,
                    courtNumber,
                    judgeName,
                    assignment
                };
                
                document.getElementById('judge-login').classList.add('hidden');
                document.getElementById('score-sheet').classList.remove('hidden');
                
                // Reset scoring state
                currentTeam = '';
                document.getElementById('petitioner-btn').classList.remove('hidden');
                document.getElementById('respondent-btn').classList.add('hidden');
            }
        });

        function selectTeam(team) {
            currentTeam = team;
            document.getElementById('current-team').textContent = 
                team === 'petitioner' ? 'Scoring Petitioner Team' : 'Scoring Respondent Team';
            document.getElementById('scoring-form').classList.remove('hidden');
            document.getElementById('team-selection').classList.add('hidden');
            
            // Clear previous scores
            document.querySelectorAll('#scoring-form input[type="number"]').forEach(input => {
                input.value = '';
            });
            document.querySelectorAll('#scoring-form select').forEach(select => {
                select.value = '';
            });
        }

        function submitTeamScore() {
            // Validate all fields are filled
            const requiredFields = document.querySelectorAll('#scoring-form [required]');
            let allFilled = true;
            
            requiredFields.forEach(field => {
                if (!field.value) {
                    allFilled = false;
                    field.classList.add('border-red-500');
                } else {
                    field.classList.remove('border-red-500');
                }
            });
            
            if (!allFilled) {
                alert('Please fill all required fields including speaker genders.');
                return;
            }

            // Collect scores
            const scores = {
                judgeSession: currentJudgeSession,
                team: currentTeam,
                teamCode: currentTeam === 'petitioner' ? 
                    currentJudgeSession.assignment.petitionerCode : 
                    currentJudgeSession.assignment.respondentCode,
                speaker1: {
                    gender: document.getElementById('speaker1-gender').value,
                    perusal: parseInt(document.getElementById('s1-perusal').value),
                    knowledge: parseInt(document.getElementById('s1-knowledge').value),
                    organization: parseInt(document.getElementById('s1-organization').value),
                    clarity: parseInt(document.getElementById('s1-clarity').value),
                    persuasiveness: parseInt(document.getElementById('s1-persuasiveness').value),
                    coordination: parseInt(document.getElementById('s1-coordination').value),
                    etiquette: parseInt(document.getElementById('s1-etiquette').value)
                },
                speaker2: {
                    gender: document.getElementById('speaker2-gender').value,
                    perusal: parseInt(document.getElementById('s2-perusal').value),
                    knowledge: parseInt(document.getElementById('s2-knowledge').value),
                    organization: parseInt(document.getElementById('s2-organization').value),
                    clarity: parseInt(document.getElementById('s2-clarity').value),
                    persuasiveness: parseInt(document.getElementById('s2-persuasiveness').value),
                    coordination: parseInt(document.getElementById('s2-coordination').value),
                    etiquette: parseInt(document.getElementById('s2-etiquette').value)
                },
                timestamp: new Date().toISOString()
            };

            // Calculate totals
            scores.speaker1.total = Object.values(scores.speaker1).reduce((sum, val) => 
                typeof val === 'number' ? sum + val : sum, 0);
            scores.speaker2.total = Object.values(scores.speaker2).reduce((sum, val) => 
                typeof val === 'number' ? sum + val : sum, 0);
            scores.teamTotal = scores.speaker1.total + scores.speaker2.total;

            judgeScores.push(scores);
            localStorage.setItem('judgeScores', JSON.stringify(judgeScores));

            // Move to next team or finish
            if (currentTeam === 'petitioner') {
                document.getElementById('petitioner-btn').classList.add('hidden');
                document.getElementById('respondent-btn').classList.remove('hidden');
                document.getElementById('scoring-form').classList.add('hidden');
                document.getElementById('team-selection').classList.remove('hidden');
                alert('Petitioner scores submitted! Please score the Respondent team.');
            } else {
                // Both teams scored, show thank you
                document.getElementById('scoring-section').classList.add('hidden');
                document.getElementById('thank-you-card').classList.remove('hidden');
            }
        }

        function resetJudgePortal() {
            document.getElementById('judge-login').classList.remove('hidden');
            document.getElementById('score-sheet').classList.add('hidden');
            document.getElementById('thank-you-card').classList.add('hidden');
            document.getElementById('scoring-section').classList.remove('hidden');
            document.getElementById('judge-login-form').reset();
            currentJudgeSession = null;
        }

        // Court Manager Portal Functions
        function loadManagerData() {
            const select = document.getElementById('manager-name-select');
            select.innerHTML = '<option value="">Select Manager</option>';
            
            courtAssignments.forEach(assignment => {
                const option = document.createElement('option');
                option.value = assignment.managerName;
                option.textContent = assignment.managerName;
                option.dataset.assignmentId = assignment.id;
                select.appendChild(option);
            });
        }

        document.getElementById('manager-name-select').addEventListener('change', function() {
            const assignmentId = this.selectedOptions[0]?.dataset.assignmentId;
            const roundSelect = document.getElementById('manager-round');
            roundSelect.innerHTML = '<option value="">Select Round</option>';
            
            if (assignmentId) {
                const assignment = courtAssignments.find(a => a.id == assignmentId);
                if (assignment) {
                    const competition = competitions.find(c => c.id == assignment.competitionId);
                    if (competition) {
                        competition.rounds.forEach(round => {
                            const option = document.createElement('option');
                            option.value = round;
                            option.textContent = round.charAt(0).toUpperCase() + round.slice(1);
                            roundSelect.appendChild(option);
                        });
                    }
                }
            }
        });

        document.getElementById('manager-login-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const managerName = document.getElementById('manager-name-select').value;
            const password = document.getElementById('manager-login-password').value;
            const round = document.getElementById('manager-round').value;
            
            const assignment = courtAssignments.find(a => 
                a.managerName === managerName && a.managerPassword === password
            );
            
            if (assignment) {
                currentManagerSession = {
                    assignment,
                    round,
                    managerName
                };
                
                document.getElementById('manager-login').classList.add('hidden');
                document.getElementById('time-keeping').classList.remove('hidden');
                
                // Set up time calculation listeners
                setupTimeCalculation();
            } else {
                alert('Invalid credentials!');
            }
        });

        function setupTimeCalculation() {
            const inputs = ['pet-s1-time', 'pet-s2-time', 'pet-rebuttal-time', 'res-s1-time', 'res-s2-time', 'res-rebuttal-time'];
            
            inputs.forEach(inputId => {
                document.getElementById(inputId).addEventListener('input', function() {
                    const prefix = inputId.startsWith('pet') ? 'pet' : 'res';
                    const s1 = parseInt(document.getElementById(`${prefix}-s1-time`).value) || 0;
                    const s2 = parseInt(document.getElementById(`${prefix}-s2-time`).value) || 0;
                    const rebuttal = parseInt(document.getElementById(`${prefix}-rebuttal-time`).value) || 0;
                    const total = s1 + s2 + rebuttal;
                    
                    document.getElementById(`${prefix}-total`).textContent = total;
                    
                    if (total > 30) {
                        document.getElementById(`${prefix}-total`).classList.add('text-red-600');
                    } else {
                        document.getElementById(`${prefix}-total`).classList.remove('text-red-600');
                    }
                });
            });
        }

        function startTimekeeping() {
            // Validate time allocation
            const petTotal = parseInt(document.getElementById('pet-total').textContent);
            const resTotal = parseInt(document.getElementById('res-total').textContent);
            
            if (petTotal !== 30 || resTotal !== 30) {
                alert('Each team must have exactly 30 minutes total time allocation!');
                return;
            }
            
            // Set up speaker queue
            speakerQueue = [
                { team: 'Petitioner', speaker: 'Speaker 1', time: parseInt(document.getElementById('pet-s1-time').value) * 60 },
                { team: 'Petitioner', speaker: 'Speaker 2', time: parseInt(document.getElementById('pet-s2-time').value) * 60 },
                { team: 'Petitioner', speaker: 'Rebuttal', time: parseInt(document.getElementById('pet-rebuttal-time').value) * 60 },
                { team: 'Respondent', speaker: 'Speaker 1', time: parseInt(document.getElementById('res-s1-time').value) * 60 },
                { team: 'Respondent', speaker: 'Speaker 2', time: parseInt(document.getElementById('res-s2-time').value) * 60 },
                { team: 'Respondent', speaker: 'Rebuttal', time: parseInt(document.getElementById('res-rebuttal-time').value) * 60 }
            ];
            
            currentSpeakerIndex = 0;
            currentTimerData = {
                timeRemaining: speakerQueue[0].time,
                originalTime: speakerQueue[0].time,
                isRunning: false,
                startTime: null,
                speakerTimes: []
            };
            
            document.getElementById('time-setup').classList.add('hidden');
            document.getElementById('timer-display').classList.remove('hidden');
            
            updateCurrentSpeaker();
            updateTimerDisplay();
            updateProgressTracking();
        }

        function updateCurrentSpeaker() {
            const current = speakerQueue[currentSpeakerIndex];
            document.getElementById('current-speaker').textContent = 
                `${current.team} - ${current.speaker}`;
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(currentTimerData.timeRemaining / 60);
            const seconds = Math.floor(currentTimerData.timeRemaining % 60);
            const milliseconds = Math.floor((currentTimerData.timeRemaining % 1) * 1000);
            
            document.getElementById('timer').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}:${milliseconds.toString().padStart(3, '0')}`;
        }

        function startTimer() {
            if (!currentTimerData.isRunning) {
                currentTimerData.isRunning = true;
                currentTimerData.startTime = Date.now();
                
                document.getElementById('start-btn').classList.add('hidden');
                document.getElementById('pause-btn').classList.remove('hidden');
                document.getElementById('next-speaker-btn').classList.remove('hidden');
                
                timerInterval = setInterval(updateTimer, 10); // Update every 10ms for milliseconds
            }
        }

        function pauseTimer() {
            if (currentTimerData.isRunning) {
                currentTimerData.isRunning = false;
                clearInterval(timerInterval);
                
                document.getElementById('start-btn').classList.remove('hidden');
                document.getElementById('pause-btn').classList.add('hidden');
            }
        }

        function updateTimer() {
            if (currentTimerData.isRunning) {
                currentTimerData.timeRemaining -= 0.01; // Decrease by 10ms
                
                if (currentTimerData.timeRemaining <= 0) {
                    currentTimerData.timeRemaining = 0;
                    pauseTimer();
                    ringBell(5000); // Long ring for 5 seconds
                    nextSpeaker();
                    return;
                }
                
                // Check for bell rings
                const elapsed = currentTimerData.originalTime - currentTimerData.timeRemaining;
                const halfTime = currentTimerData.originalTime / 2;
                const lastFiveMinutes = 5 * 60;
                
                if (Math.abs(elapsed - halfTime) < 0.1) {
                    ringBell(1000); // Bell at half time
                } else if (Math.abs(currentTimerData.timeRemaining - lastFiveMinutes) < 0.1) {
                    ringBell(1000); // Bell at last 5 minutes
                }
                
                updateTimerDisplay();
            }
        }

        function ringBell(duration) {
            const bell = document.getElementById('bell');
            bell.classList.add('bell-animation');
            
            // Play bell sound (visual indication)
            setTimeout(() => {
                bell.classList.remove('bell-animation');
            }, duration);
        }

        function addExtraTime(seconds) {
            currentTimerData.timeRemaining += seconds;
            currentTimerData.originalTime += seconds;
            updateTimerDisplay();
        }

        function nextSpeaker() {
            // Record current speaker time
            const speakerTime = {
                team: speakerQueue[currentSpeakerIndex].team,
                speaker: speakerQueue[currentSpeakerIndex].speaker,
                allocatedTime: speakerQueue[currentSpeakerIndex].time,
                actualTime: currentTimerData.originalTime - currentTimerData.timeRemaining,
                timestamp: new Date().toISOString()
            };
            
            currentTimerData.speakerTimes.push(speakerTime);
            
            currentSpeakerIndex++;
            
            if (currentSpeakerIndex >= speakerQueue.length) {
                // All speakers done
                pauseTimer();
                document.getElementById('submit-timekeeping').classList.remove('hidden');
                document.getElementById('current-speaker').textContent = 'All speakers completed';
                document.getElementById('timer').textContent = '00:00:000';
                document.getElementById('start-btn').classList.add('hidden');
                document.getElementById('pause-btn').classList.add('hidden');
                document.getElementById('next-speaker-btn').classList.add('hidden');
            } else {
                // Move to next speaker
                currentTimerData.timeRemaining = speakerQueue[currentSpeakerIndex].time;
                currentTimerData.originalTime = speakerQueue[currentSpeakerIndex].time;
                currentTimerData.isRunning = false;
                
                document.getElementById('start-btn').classList.remove('hidden');
                document.getElementById('pause-btn').classList.add('hidden');
                
                updateCurrentSpeaker();
                updateTimerDisplay();
            }
            
            updateProgressTracking();
        }

        function updateProgressTracking() {
            const container = document.getElementById('progress-list');
            container.innerHTML = '';
            
            currentTimerData.speakerTimes.forEach(time => {
                const div = document.createElement('div');
                div.className = 'text-sm text-gray-600';
                const actualMinutes = Math.floor(time.actualTime / 60);
                const actualSeconds = Math.floor(time.actualTime % 60);
                div.textContent = `${time.team} ${time.speaker}: ${actualMinutes}:${actualSeconds.toString().padStart(2, '0')}`;
                container.appendChild(div);
            });
        }

        function submitTimekeeping() {
            const timekeepingRecord = {
                id: Date.now(),
                managerSession: currentManagerSession,
                speakerTimes: currentTimerData.speakerTimes,
                totalTime: currentTimerData.speakerTimes.reduce((sum, time) => sum + time.actualTime, 0),
                timestamp: new Date().toISOString()
            };
            
            timekeepingData.push(timekeepingRecord);
            localStorage.setItem('timekeepingData', JSON.stringify(timekeepingData));
            
            document.getElementById('time-keeping').classList.add('hidden');
            document.getElementById('manager-thank-you').classList.remove('hidden');
        }

        function resetManagerPortal() {
            document.getElementById('manager-login').classList.remove('hidden');
            document.getElementById('time-keeping').classList.add('hidden');
            document.getElementById('manager-thank-you').classList.add('hidden');
            document.getElementById('time-setup').classList.remove('hidden');
            document.getElementById('timer-display').classList.add('hidden');
            document.getElementById('manager-login-form').reset();
            
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            currentManagerSession = null;
            currentTimerData = null;
            speakerQueue = [];
            currentSpeakerIndex = 0;
        }

        // Dashboard Functions
        function loadDashboard() {
            const select = document.getElementById('dashboard-competition');
            select.innerHTML = '<option value="">Select Competition</option>';
            
            competitions.forEach(comp => {
                const option = document.createElement('option');
                option.value = comp.id;
                option.textContent = comp.competitionName;
                select.appendChild(option);
            });
        }

        document.getElementById('dashboard-competition').addEventListener('change', function() {
            const competitionId = this.value;
            if (competitionId) {
                loadDashboardContent(competitionId);
                document.getElementById('dashboard-content').classList.remove('hidden');
            } else {
                document.getElementById('dashboard-content').classList.add('hidden');
            }
        });

        function loadDashboardContent(competitionId) {
            const competition = competitions.find(c => c.id == competitionId);
            if (!competition) return;
            
            // Create round tabs
            const tabsContainer = document.getElementById('round-tabs');
            tabsContainer.innerHTML = '';
            
            const rounds = competition.rounds;
            
            // Add combined prelims tab if both prelims exist
            if (rounds.includes('prelims1') && rounds.includes('prelims2')) {
                rounds.splice(rounds.indexOf('prelims2') + 1, 0, 'combined-prelims');
            }
            
            rounds.forEach((round, index) => {
                const tab = document.createElement('button');
                tab.className = `py-4 px-6 text-sm font-medium border-b-2 ${index === 0 ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'}`;
                tab.textContent = round === 'combined-prelims' ? 'Combined Prelims' : round.charAt(0).toUpperCase() + round.slice(1);
                tab.onclick = () => showRoundContent(competitionId, round, tab);
                tabsContainer.appendChild(tab);
            });
            
            // Show first round by default
            if (rounds.length > 0) {
                showRoundContent(competitionId, rounds[0]);
            }
        }

        function showRoundContent(competitionId, round, clickedTab = null) {
            // Update active tab
            if (clickedTab) {
                document.querySelectorAll('#round-tabs button').forEach(tab => {
                    tab.className = tab.className.replace('border-blue-500 text-blue-600', 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300');
                });
                clickedTab.className = clickedTab.className.replace('border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300', 'border-blue-500 text-blue-600');
            }
            
            const content = document.getElementById('round-content');
            
            if (round === 'prelims1' || round === 'prelims2') {
                showPrelimsContent(competitionId, round, content);
            } else if (round === 'combined-prelims') {
                showCombinedPrelimsContent(competitionId, content);
            } else {
                showKnockoutContent(competitionId, round, content);
            }
        }

        function showPrelimsContent(competitionId, round, container) {
            const scores = judgeScores.filter(score => 
                score.judgeSession.competitionId == competitionId &&
                score.judgeSession.assignment.round === round
            );
            
            container.innerHTML = `
                <h3 class="text-2xl font-semibold mb-6">${round.charAt(0).toUpperCase() + round.slice(1)} Results</h3>
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white border border-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rank</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Team Code</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Total Score</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            ${generatePrelimsRows(scores)}
                        </tbody>
                    </table>
                </div>
            `;
        }

        function generatePrelimsRows(scores) {
            // Group scores by team
            const teamScores = {};
            scores.forEach(score => {
                if (!teamScores[score.teamCode]) {
                    teamScores[score.teamCode] = [];
                }
                teamScores[score.teamCode].push(score);
            });
            
            // Calculate average scores for each team
            const teamAverages = Object.keys(teamScores).map(teamCode => {
                const teamScoreList = teamScores[teamCode];
                const totalScore = teamScoreList.reduce((sum, score) => sum + score.teamTotal, 0);
                const averageScore = totalScore / teamScoreList.length;
                
                return {
                    teamCode,
                    averageScore: averageScore.toFixed(2),
                    scores: teamScoreList
                };
            });
            
            // Sort by average score (descending)
            teamAverages.sort((a, b) => b.averageScore - a.averageScore);
            
            return teamAverages.map((team, index) => `
                <tr>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${index + 1}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 cursor-pointer text-blue-600 hover:text-blue-800" onclick="showTeamDetails('${team.teamCode}')">${team.teamCode}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${team.averageScore}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        <button onclick="downloadTeamPDF('${team.teamCode}')" class="bg-blue-600 hover:bg-blue-700 text-white py-1 px-3 rounded text-xs transition-colors">Download PDF</button>
                    </td>
                </tr>
            `).join('');
        }

        function showCombinedPrelimsContent(competitionId, container) {
            const prelims1Scores = judgeScores.filter(score => 
                score.judgeSession.competitionId == competitionId &&
                score.judgeSession.assignment.round === 'prelims1'
            );
            
            const prelims2Scores = judgeScores.filter(score => 
                score.judgeSession.competitionId == competitionId &&
                score.judgeSession.assignment.round === 'prelims2'
            );
            
            // Combine scores
            const teamScores = {};
            
            [...prelims1Scores, ...prelims2Scores].forEach(score => {
                if (!teamScores[score.teamCode]) {
                    teamScores[score.teamCode] = {
                        prelims1: [],
                        prelims2: [],
                        totalTime: 0
                    };
                }
                
                if (score.judgeSession.assignment.round === 'prelims1') {
                    teamScores[score.teamCode].prelims1.push(score);
                } else {
                    teamScores[score.teamCode].prelims2.push(score);
                }
            });
            
            // Add timing data
            timekeepingData.forEach(timeData => {
                const assignment = timeData.managerSession.assignment;
                const petitionerCode = assignment.petitionerCode;
                const respondentCode = assignment.respondentCode;
                
                if (teamScores[petitionerCode]) {
                    const petitionerTime = timeData.speakerTimes
                        .filter(t => t.team === 'Petitioner')
                        .reduce((sum, t) => sum + t.actualTime, 0);
                    teamScores[petitionerCode].totalTime += petitionerTime;
                }
                
                if (teamScores[respondentCode]) {
                    const respondentTime = timeData.speakerTimes
                        .filter(t => t.team === 'Respondent')
                        .reduce((sum, t) => sum + t.actualTime, 0);
                    teamScores[respondentCode].totalTime += respondentTime;
                }
            });
            
            // Calculate combined scores
            const combinedResults = Object.keys(teamScores).map(teamCode => {
                const team = teamScores[teamCode];
                
                const prelims1Avg = team.prelims1.length > 0 ? 
                    team.prelims1.reduce((sum, score) => sum + score.teamTotal, 0) / team.prelims1.length : 0;
                const prelims2Avg = team.prelims2.length > 0 ? 
                    team.prelims2.reduce((sum, score) => sum + score.teamTotal, 0) / team.prelims2.length : 0;
                
                return {
                    teamCode,
                    prelims1Score: prelims1Avg.toFixed(2),
                    prelims2Score: prelims2Avg.toFixed(2),
                    combinedScore: (prelims1Avg + prelims2Avg).toFixed(2),
                    totalTime: team.totalTime
                };
            });
            
            // Sort by combined score, then by time (for tie-breaking)
            combinedResults.sort((a, b) => {
                if (b.combinedScore !== a.combinedScore) {
                    return b.combinedScore - a.combinedScore;
                }
                return a.totalTime - b.totalTime; // Less time is better
            });
            
            // Mark top 16 for qualification
            const qualifiedTeams = combinedResults.slice(0, 16);
            
            container.innerHTML = `
                <h3 class="text-2xl font-semibold mb-6">Combined Prelims Results</h3>
                <div class="mb-4 text-sm text-gray-600">
                    <p>Top 16 teams qualify for Octa Finals. Ties are broken by total time taken (less time is better).</p>
                </div>
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white border border-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rank</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Team Code</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Prelims 1</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Prelims 2</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Combined</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Total Time</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            ${combinedResults.map((team, index) => `
                                <tr class="${index < 16 ? 'bg-green-50' : 'bg-red-50'}">
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${index + 1}</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 cursor-pointer text-blue-600 hover:text-blue-800" onclick="showTeamDetails('${team.teamCode}')">${team.teamCode}</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${team.prelims1Score}</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${team.prelims2Score}</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900">${team.combinedScore}</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${Math.floor(team.totalTime / 60)}:${Math.floor(team.totalTime % 60).toString().padStart(2, '0')}</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium ${index < 16 ? 'text-green-600' : 'text-red-600'}">${index < 16 ? 'Qualified' : 'Eliminated'}</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                                        <button onclick="downloadTeamPDF('${team.teamCode}')" class="bg-blue-600 hover:bg-blue-700 text-white py-1 px-3 rounded text-xs transition-colors">Download PDF</button>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        }

        function showKnockoutContent(competitionId, round, container) {
            container.innerHTML = `
                <h3 class="text-2xl font-semibold mb-6">${round.charAt(0).toUpperCase() + round.slice(1)} - Knockout Round</h3>
                <div class="text-center text-gray-600">
                    <p>Knockout round results will be displayed here based on match outcomes.</p>
                    <p class="mt-2">This feature requires match result input functionality.</p>
                </div>
            `;
        }

        function showTeamDetails(teamCode) {
            const teamScores = judgeScores.filter(score => score.teamCode === teamCode);
            const teamTiming = timekeepingData.filter(timeData => 
                timeData.managerSession.assignment.petitionerCode === teamCode ||
                timeData.managerSession.assignment.respondentCode === teamCode
            );
            
            let detailsHTML = `
                <div class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50" onclick="closeTeamDetails()">
                    <div class="relative top-20 mx-auto p-5 border w-11/12 max-w-4xl shadow-lg rounded-md bg-white" onclick="event.stopPropagation()">
                        <div class="mt-3">
                            <h3 class="text-2xl font-semibold text-gray-900 mb-4">Team ${teamCode} - Detailed Scores</h3>
                            <div class="space-y-6">
            `;
            
            teamScores.forEach(score => {
                detailsHTML += `
                    <div class="border rounded-lg p-4">
                        <h4 class="text-lg font-semibold mb-2">${score.judgeSession.assignment.round} - ${score.team} - Judge: ${score.judgeSession.judgeName}</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="border rounded p-3">
                                <h5 class="font-semibold mb-2">Speaker 1 (${score.speaker1.gender})</h5>
                                <div class="text-sm space-y-1">
                                    <div>Perusal of Facts: ${score.speaker1.perusal}/10</div>
                                    <div>Knowledge & Application: ${score.speaker1.knowledge}/20</div>
                                    <div>Organization & Presentation: ${score.speaker1.organization}/20</div>
                                    <div>Clarity & Reasoning: ${score.speaker1.clarity}/20</div>
                                    <div>Persuasiveness: ${score.speaker1.persuasiveness}/20</div>
                                    <div>Team Coordination: ${score.speaker1.coordination}/10</div>
                                    <div>Courtroom Etiquette: ${score.speaker1.etiquette}/10</div>
                                    <div class="font-semibold">Total: ${score.speaker1.total}/110</div>
                                </div>
                            </div>
                            <div class="border rounded p-3">
                                <h5 class="font-semibold mb-2">Speaker 2 (${score.speaker2.gender})</h5>
                                <div class="text-sm space-y-1">
                                    <div>Perusal of Facts: ${score.speaker2.perusal}/10</div>
                                    <div>Knowledge & Application: ${score.speaker2.knowledge}/20</div>
                                    <div>Organization & Presentation: ${score.speaker2.organization}/20</div>
                                    <div>Clarity & Reasoning: ${score.speaker2.clarity}/20</div>
                                    <div>Persuasiveness: ${score.speaker2.persuasiveness}/20</div>
                                    <div>Team Coordination: ${score.speaker2.coordination}/10</div>
                                    <div>Courtroom Etiquette: ${score.speaker2.etiquette}/10</div>
                                    <div class="font-semibold">Total: ${score.speaker2.total}/110</div>
                                </div>
                            </div>
                        </div>
                        <div class="mt-3 text-center">
                            <div class="text-lg font-semibold">Team Total: ${score.teamTotal}/220</div>
                        </div>
                    </div>
                `;
            });
            
            // Add timing information
            teamTiming.forEach(timeData => {
                const isTeamPetitioner = timeData.managerSession.assignment.petitionerCode === teamCode;
                const teamType = isTeamPetitioner ? 'Petitioner' : 'Respondent';
                const relevantTimes = timeData.speakerTimes.filter(t => t.team === teamType);
                
                detailsHTML += `
                    <div class="border rounded-lg p-4 bg-blue-50">
                        <h4 class="text-lg font-semibold mb-2">Timing Data - ${timeData.managerSession.round} (${teamType})</h4>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            ${relevantTimes.map(time => `
                                <div class="text-sm">
                                    <div class="font-semibold">${time.speaker}</div>
                                    <div>Allocated: ${Math.floor(time.allocatedTime / 60)}:${Math.floor(time.allocatedTime % 60).toString().padStart(2, '0')}</div>
                                    <div>Actual: ${Math.floor(time.actualTime / 60)}:${Math.floor(time.actualTime % 60).toString().padStart(2, '0')}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            });
            
            detailsHTML += `
                            </div>
                            <div class="mt-6 text-center">
                                <button onclick="closeTeamDetails()" class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded transition-colors">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', detailsHTML);
        }

        function closeTeamDetails() {
            const modal = document.querySelector('.fixed.inset-0');
            if (modal) {
                modal.remove();
            }
        }

        function downloadTeamPDF(teamCode) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            const teamScores = judgeScores.filter(score => score.teamCode === teamCode);
            const teamTiming = timekeepingData.filter(timeData => 
                timeData.managerSession.assignment.petitionerCode === teamCode ||
                timeData.managerSession.assignment.respondentCode === teamCode
            );
            
            doc.setFontSize(20);
            doc.text(`Team ${teamCode} - Score Sheet`, 20, 20);
            
            let yPosition = 40;
            
            teamScores.forEach(score => {
                doc.setFontSize(14);
                doc.text(`${score.judgeSession.assignment.round} - ${score.team}`, 20, yPosition);
                doc.text(`Judge: ${score.judgeSession.judgeName}`, 20, yPosition + 10);
                
                yPosition += 25;
                
                doc.setFontSize(10);
                doc.text('Speaker 1:', 20, yPosition);
                doc.text(`Gender: ${score.speaker1.gender}`, 80, yPosition);
                doc.text(`Total: ${score.speaker1.total}/110`, 140, yPosition);
                
                yPosition += 15;
                
                doc.text('Speaker 2:', 20, yPosition);
                doc.text(`Gender: ${score.speaker2.gender}`, 80, yPosition);
                doc.text(`Total: ${score.speaker2.total}/110`, 140, yPosition);
                
                yPosition += 15;
                
                doc.setFontSize(12);
                doc.text(`Team Total: ${score.teamTotal}/220`, 20, yPosition);
                
                yPosition += 25;
                
                if (yPosition > 250) {
                    doc.addPage();
                    yPosition = 20;
                }
            });
            
            doc.save(`Team_${teamCode}_ScoreSheet.pdf`);
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            showPortal('admin');
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96759ddea2106cd6',t:'MTc1Mzg4NjQ4NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
